{% extends 'base.html' %}
{% load crispy_forms_tags %}
{% block content %}

<div class="container">
  <div class="row justify-content-center">
    <div class="col-8">
      <hr class="mt-0 mb-4">

      <head>
        <title>Listings</title>
      </head>
      <body>
        <h1>Listings</h1>

        <button onclick="show_dialog()">Filter</button>

        <div id="dialog">
          <h3>Filters</h3>
          <ul style="list-style: none;">
            <li><label for="name">Name:</label> <input id="name" type="text"></li>
            <li><input id="laundry" type="checkbox"> <label for="laundry">Laundry</label></li>
            <li><input id="parking" type="checkbox"> <label for="parking">Parking</label></li>
            <li><input id="owned" type="checkbox"> <label for="owned">Owned</label></li>
            <li><label for="price_low">Price higher than:</label> <input id="price_low" type="text">
            <label for="price_high">Price lower than:</label> <input id="price_high" type="text"></li>
            <li><label for="rating_low">Rating higher than:</label> <input id="rating_low" type="text">
            <label for="rating_high">Rating lower than:</label> <input id="rating_high" type="text"></li>
            <li><label for="sqft_low">Square footage higher than:</label> <input id="sqft_low" type="text">
            <label for="sqft_high">Square footage lower than:</label> <input id="sqft_high" type="text"></li>
            <li><label for="beds_low"># Beds higher than:</label> <input id="beds_low" type="text">
            <label for="beds_high"># Beds lower than:</label> <input id="beds_high" type="text"></li>

          </ul>




        </div>

        <script type="text/javascript">
        $( "#dialog" ).dialog({
            dialogClass: "dialogs",
            buttons: [
              {
                text: "Apply filters",
                click: function() {

                  var inputs = $("#dialog").children("ul").children("li").children("input");
                  var url = "?";
                  inputs.each(function(){
                    var type = $(this).attr("type");
                    if(type == "text"){
                      var text = $(this).val();
                      var id = $(this).attr("id")
                      if(text.length > 0){
                        url += id + "=" + text + "&"
                      }
                    }
                  });

                  // alert(url);

                  window.location = url;


                }
              }
            ]
          });

          $(".dialogs").css("width","80%");
          $(".dialogs").css("top","20%");
          $(".dialogs").css("left","10%");
          $(".dialogs").hide();

          function show_dialog(){
            $(".dialogs").show();
          }
        </script>

        <button id="show-list">List view</button>
        <button id="show-map">Map view</button>

        <div class="list-of-listings">
          {% if list_of_listings %}

            {% for listing in list_of_listings %}
              {% include 'listings/one_listing_condensed.html' %}
            {% endfor %}


          {% else %}
            <p>No listings are available. :(</p>
          {% endif %}
        </div>

        <div class="map">
          This is the map!
        </div>

        <script type="text/javascript">
          $("#show-list").click(function(){
            $(".map").hide()
            $(".list-of-listings").show();
          });
          $("#show-map").click(function(){
            $(".list-of-listings").hide();
            $(".map").show()
          });
        </script>





      </body>

    </div>
  </div>
</div>




{% endblock %}
