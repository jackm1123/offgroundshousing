{% extends 'base.html' %}
{% block content %}



{% if listing %}
{% load static %}

  <script type="text/javascript" src="{% static 'listings/jquery.js' %}"></script>
  <script type="text/javascript" src="{% static 'listings/rating.js' %}"></script>
  <link rel="stylesheet" href="{% static 'listings/one_listing.css' %}">


  <style>
    #map {
      height: 400px;
      width: 100%;
    }
  </style>


<div class="test">


  <div class="name">
    <h1>{{ listing.name }}</h1>
    <div class="rating">
      {% include 'listings/rating.html' %}

    </div>
    <div class="price">
      <h3>${{ listing.price }}</h3>
    </div>
  </div>



  <div class="pics" style="border: 2px solid black;">
    <p>Pics</p>


    <!-- <img src="{% static 'listings/pics/4/'|add:listing.pictures %}" alt=""> -->
    {% if listing.pictures %}
    <img src="{% static 'listings/pics/' %}{{ listing.id }}/{{ listing.pictures }}" alt="">
    {% else %}
    <p>No pictures</p>
    {% endif %}


  </div>

  <div class="description">
      <h3>Description</h3> <br/> {{ listing.description }}
  </div>

  <div class="at-a-glance">
    <h3>At a glance</h3>

    <!-- <table style="width:20%;">
      <tr>
        <td><img src="{% static 'listings/bed_icon.png' %}" alt="bed icon"></td>
        <td><p><strong>bedroom_num:</strong> {{ listing.bedroom_num }}<p></td>
      </tr>
    </table> -->

    <div class="bullet_pair">
      <img class="bullet_icon" src="{% static 'listings/icons/laundry.png' %}" alt="laundry icon">
      <div class="bullet_pair_body">
        <strong>Laundry</strong> <br/>
        {{ listing.laundry_info }}
      </div>
    </div>


    <div class="bullet_pair">
      <img class="bullet_icon" src="{% static 'listings/icons/sqft.png' %}" alt="sqft icon">
      <div class="bullet_pair_body">
        <strong>square_footage</strong> <br/>
        {{ listing.square_footage }} sqft
      </div>
    </div>


    <div class="bullet_pair" id="bullet_pair_price">
      <img class="bullet_icon" src="{% static 'listings/icons/price.png' %}" alt="price icon">
      <div class="bullet_pair_body">
        <strong>price</strong> <br/>
        ${{ listing.price }}
      </div>
    </div>

    <div class="bullet_pair">
      <img class="bullet_icon" src="{% static 'listings/icons/bed.png' %}" alt="bed icon">
      <div class="bullet_pair_body">
        <strong>Beds</strong> <br/>
        {{ listing.bedroom_num }}
      </div>
    </div>

    <div class="bullet_pair">
      <img class="bullet_icon" src="{% static 'listings/icons/available.png' %}" alt="owner icon">
      <div class="bullet_pair_body">
        <strong>Available</strong> <br/>
        {{ listing.ownership_info }}
      </div>
    </div>

    <div class="bullet_pair">
      <img class="bullet_icon" src="{% static 'listings/icons/calendar.png' %}" alt="date icon">
      <div class="bullet_pair_body">
        <strong>Posted</strong> <br/>
        {{ listing.get_day }}
      </div>
    </div>

  </div>

  <div class="contact-info">
    <h3>Contact</h3>


    <div class="bullet_pair">
      <img class="bullet_icon" src="{% static 'listings/icons/phone.png' %}" alt="sqft icon">
      <div class="bullet_pair_body">
        <strong>Phone</strong><br>
        {{ listing.phone_num }}
      </div>
    </div>

    <div class="bullet_pair">
      <img class="bullet_icon" src="{% static 'listings/icons/email.png' %}" alt="sqft icon">
      <div class="bullet_pair_body">
        <strong>Email</strong><br>
        add_this_to_model@yahoo.com
        <!-- {{ listing.email }} -->
      </div>
    </div>

    <!-- <p>{{ listing.address }}</p> -->
    <!-- Email -->
  </div>

  <div id="map"></div>
  <!-- Replace the value of the key parameter with your own API key. -->
  <script async defer
    src="https://maps.googleapis.com/maps/api/js?key=AIzaSyC01WGGqQ_6fkdF_nJNUj4q9G6WF7BUXTs&callback=initMap">
  </script>


  <script>
    function initMap() {
      // The location of Uluru
      var latt = Number("{{listing.latitude}}")
      var long = Number("{{listing.longitude}}")
      if (latt === ""){
        latt = 38.034
      }
      if (long === ""){
        long = 131.036
      }

      var location = {lat: latt, lng: long};
      // The map, centered at Uluru
      var map = new google.maps.Map(
          document.getElementById('map'), {zoom: 15, center: location});
      // The marker, positioned at Uluru
      var marker = new google.maps.Marker({position: location, map: map});
    }
  </script>


{% else %}
    <p>WHAT. No listing. :p This should have been handled by the 404 page...</p>
{% endif %}

</div>

<!--
Experimental
<script type="text/javascript">

var topofDiv = $(".name").offset().top; //gets offset of header
var height = $(".name").outerHeight()

var flip = true;

$(window).scroll(function(){
    var name = $(".name");
    var title = $(".name h1");
    var price = $(".name price").children("h3");
    if(flip && $(window).scrollTop() > (topofDiv + height/4)){
      var save_size = title.css("font-size");
      title.prop("save_size",save_size);
      title.css("font-size","100%");
      price.css("font-size","10px");
      flip = false;
    }
    else if(!flip && $(window).scrollTop() < (topofDiv)){
      flip = true;
      var save_size = title.prop("save_size");
      if(save_size.length > 0){
        title.css("font-size",title.prop("save_size"));
        title.prop("save_size","")
      }
    }
});

</script>

-->

{% endblock %}
